<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Golf Scorecard">
    <meta name="description" content="Application √©l√©gante de suivi de scores de golf pour iPhone">
    <meta name="keywords" content="golf, scorecard, scores, iPhone, webapp">
    <meta name="author" content="Golf App">
    <title>Golf Scorecard Pro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a4332, #2d5a47);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 100vw;
            padding: 20px 15px;
            min-height: 100vh;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .header h1 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .card {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .btn {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 80px;
        }

        .btn:hover, .btn:active {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
        }

        .btn.selected {
            background: linear-gradient(135deg, #2E7D32, #1B5E20);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
        }

        .btn-primary {
            background: linear-gradient(135deg, #FF6B35, #FF5722);
            font-size: 18px;
            padding: 15px 30px;
            width: 100%;
            margin-top: 20px;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #757575, #424242);
            font-size: 16px;
            padding: 12px 25px;
            margin: 10px 5px;
        }

        .input-field {
            width: 100%;
            padding: 15px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 16px;
            margin: 10px 0;
        }

        .input-field::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .score-summary {
            position: sticky;
            top: 0;
            background: rgba(26, 67, 50, 0.95);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            z-index: 100;
        }

        .score-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 5px 0;
        }

        .hole-card {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .hole-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .score-input {
            width: 60px;
            padding: 8px;
            text-align: center;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 16px;
            font-weight: bold;
        }

        .player-scores {
            display: grid;
            gap: 15px;
            margin: 15px 0;
        }

        .player-score-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 15px;
            border-radius: 10px;
        }

        .score-indicator {
            font-size: 18px;
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 20px;
            min-width: 40px;
            text-align: center;
        }

        .birdie { background: #4CAF50; }
        .par { background: #9E9E9E; }
        .bogey { background: #FF5722; }
        .eagle { background: #2196F3; }
        .double-bogey { background: #9C27B0; }

        .final-results {
            background: rgba(45, 90, 71, 0.9);
            border: 2px solid #4CAF50;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .results-table th,
        .results-table td {
            padding: 12px 8px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
            font-size: 14px;
        }

        .results-table th {
            background: rgba(255, 255, 255, 0.2);
            font-weight: bold;
        }

        .winner {
            background: linear-gradient(135deg, #FFD700, #FFA000);
            color: #000;
            font-weight: bold;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            margin: 20px 0;
            font-size: 18px;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 375px) {
            .container {
                padding: 15px 10px;
            }
            
            .btn {
                padding: 10px 15px;
                font-size: 14px;
            }
            
            .results-table th,
            .results-table td {
                padding: 8px 4px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Interface 1: Configuration -->
        <div id="config-screen">
            <div class="header">
                <h1>üõ†Ô∏è Config de la partie</h1>
            </div>

            <div class="card">
                <h3>Nombre de partenaires (en plus de vous, Arthur)</h3>
                <div class="button-group">
                    <button class="btn" onclick="selectPartners(0)">0 (Solo)</button>
                    <button class="btn" onclick="selectPartners(1)">1</button>
                    <button class="btn" onclick="selectPartners(2)">2</button>
                    <button class="btn" onclick="selectPartners(3)">3</button>
                </div>
            </div>

            <div id="players-names" class="card hidden">
                <h3>Noms des partenaires</h3>
                <div id="name-inputs"></div>
            </div>

            <div class="card">
                <h3>Nombre de trous</h3>
                <div class="button-group">
                    <button class="btn" onclick="selectHoles(9)">9 trous</button>
                    <button class="btn" onclick="selectHoles(18)">18 trous</button>
                </div>
            </div>

            <button class="btn btn-primary" onclick="startGame()" id="start-btn" disabled>Commencer la partie</button>
        </div>

        <!-- Interface 2: Jeu -->
        <div id="game-screen" class="hidden">
            <div class="header">
                <h1>‚õ≥ Carte des scores</h1>
            </div>

            <div class="score-summary">
                <div id="live-scores"></div>
            </div>

            <div id="holes-container"></div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="previousHole()" id="prev-btn">Retour</button>
                <button class="btn btn-primary" onclick="validateHole()" id="validate-btn">Valider le trou</button>
            </div>
        </div>

        <!-- Interface 3: R√©sultats -->
        <div id="results-screen" class="hidden">
            <div class="header">
                <h1 id="results-title">üìÖ Partie du</h1>
            </div>

            <div class="final-results">
                <div id="winner-announcement"></div>
                <table class="results-table" id="final-table">
                </table>
            </div>

            <button class="btn btn-primary" onclick="newGame()">Nouvelle partie</button>
        </div>
    </div>

    <script>
        let gameState = {
            players: ['Arthur'],
            totalHoles: 9,
            currentHole: 1,
            scores: {},
            pars: {},
            gameStarted: false
        };

        function selectPartners(count) {
            document.querySelectorAll('#config-screen .btn').forEach(btn => btn.classList.remove('selected'));
            event.target.classList.add('selected');
            
            gameState.partnerCount = count;
            gameState.players = ['Arthur'];
            
            const playersDiv = document.getElementById('players-names');
            const nameInputsDiv = document.getElementById('name-inputs');
            
            if (count > 0) {
                playersDiv.classList.remove('hidden');
                nameInputsDiv.innerHTML = '';
                for (let i = 1; i <= count; i++) {
                    const input = document.createElement('input');
                    input.className = 'input-field';
                    input.placeholder = `Nom du partenaire ${i}`;
                    input.id = `player-${i}`;
                    nameInputsDiv.appendChild(input);
                }
            } else {
                playersDiv.classList.add('hidden');
            }
            
            checkStartButton();
        }

        function selectHoles(holes) {
            document.querySelectorAll('#config-screen .card:last-of-type .btn').forEach(btn => btn.classList.remove('selected'));
            event.target.classList.add('selected');
            gameState.totalHoles = holes;
            checkStartButton();
        }

        function checkStartButton() {
            const startBtn = document.getElementById('start-btn');
            if (gameState.partnerCount !== undefined && gameState.totalHoles) {
                startBtn.disabled = false;
            }
        }

        function startGame() {
            // R√©cup√©rer les noms des partenaires
            if (gameState.partnerCount > 0) {
                for (let i = 1; i <= gameState.partnerCount; i++) {
                    const name = document.getElementById(`player-${i}`).value.trim();
                    if (name) {
                        gameState.players.push(name);
                    } else {
                        gameState.players.push(`Partenaire ${i}`);
                    }
                }
            }

            // Initialiser les scores
            gameState.players.forEach(player => {
                gameState.scores[player] = [];
            });

            // Afficher l'√©cran de jeu
            document.getElementById('config-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.remove('hidden');
            
            createHoleInterface();
            updateLiveScores();
        }

        function createHoleInterface() {
            const container = document.getElementById('holes-container');
            container.innerHTML = '';

            const holeCard = document.createElement('div');
            holeCard.className = 'hole-card';
            holeCard.innerHTML = `
                <div class="hole-header">
                    <h3>Trou ${gameState.currentHole}</h3>
                </div>
                <div>
                    <h4>Par du trou</h4>
                    <div class="button-group">
                        <button class="btn" onclick="selectPar(3)">Par 3</button>
                        <button class="btn" onclick="selectPar(4)">Par 4</button>
                        <button class="btn" onclick="selectPar(5)">Par 5</button>
                    </div>
                </div>
                <div class="player-scores" id="player-scores">
                    ${gameState.players.map(player => `
                        <div class="player-score-row">
                            <span>${player}</span>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="number" class="score-input" id="score-${player}" min="1" max="15" placeholder="Score">
                                <span class="score-indicator" id="indicator-${player}"></span>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
            container.appendChild(holeCard);

            // Ajouter les √©v√©nements pour les scores
            gameState.players.forEach(player => {
                const input = document.getElementById(`score-${player}`);
                input.addEventListener('input', updateScoreIndicators);
            });
        }

        function selectPar(par) {
            document.querySelectorAll('.hole-card .btn').forEach(btn => btn.classList.remove('selected'));
            event.target.classList.add('selected');
            gameState.pars[gameState.currentHole] = par;
            updateScoreIndicators();
        }

        function updateScoreIndicators() {
            const par = gameState.pars[gameState.currentHole];
            if (!par) return;

            gameState.players.forEach(player => {
                const input = document.getElementById(`score-${player}`);
                const indicator = document.getElementById(`indicator-${player}`);
                const score = parseInt(input.value);

                if (score && score > 0) {
                    const diff = score - par;
                    indicator.className = 'score-indicator';
                    
                    if (diff <= -2) {
                        indicator.classList.add('eagle');
                        indicator.textContent = 'ü¶Ö';
                    } else if (diff === -1) {
                        indicator.classList.add('birdie');
                        indicator.textContent = 'üü¢';
                    } else if (diff === 0) {
                        indicator.classList.add('par');
                        indicator.textContent = '‚ö™';
                    } else if (diff === 1) {
                        indicator.classList.add('bogey');
                        indicator.textContent = 'üî¥';
                    } else {
                        indicator.classList.add('double-bogey');
                        indicator.textContent = 'üü£';
                    }
                } else {
                    indicator.textContent = '';
                    indicator.className = 'score-indicator';
                }
            });
        }

        function validateHole() {
            const par = gameState.pars[gameState.currentHole];
            if (!par) {
                alert('Veuillez s√©lectionner le par du trou');
                return;
            }

            let allScoresEntered = true;
            gameState.players.forEach(player => {
                const input = document.getElementById(`score-${player}`);
                const score = parseInt(input.value);
                if (!score || score <= 0) {
                    allScoresEntered = false;
                } else {
                    gameState.scores[player].push(score);
                }
            });

            if (!allScoresEntered) {
                alert('Veuillez entrer tous les scores');
                return;
            }

            if (gameState.currentHole >= gameState.totalHoles) {
                showResults();
            } else {
                gameState.currentHole++;
                createHoleInterface();
                updateLiveScores();
            }

            document.getElementById('prev-btn').disabled = false;
        }

        function previousHole() {
            if (gameState.currentHole > 1) {
                gameState.currentHole--;
                // Supprimer les scores du trou suivant
                gameState.players.forEach(player => {
                    gameState.scores[player].pop();
                });
                createHoleInterface();
                updateLiveScores();
            }
        }

        function updateLiveScores() {
            const container = document.getElementById('live-scores');
            container.innerHTML = '<h4>Scores en temps r√©el</h4>';

            gameState.players.forEach(player => {
                const playerScores = gameState.scores[player] || [];
                let totalScore = playerScores.reduce((sum, score) => sum + score, 0);
                let totalPar = 0;
                
                for (let i = 1; i < gameState.currentHole; i++) {
                    if (gameState.pars[i]) {
                        totalPar += gameState.pars[i];
                    }
                }

                const diff = totalScore - totalPar;
                const diffText = diff > 0 ? `+${diff}` : diff === 0 ? '¬±0' : `${diff}`;

                const scoreRow = document.createElement('div');
                scoreRow.className = 'score-row';
                scoreRow.innerHTML = `
                    <span>${player}</span>
                    <strong>${diffText}</strong>
                `;
                container.appendChild(scoreRow);
            });
        }

        function showResults() {
            document.getElementById('game-screen').classList.add('hidden');
            document.getElementById('results-screen').classList.remove('hidden');

            // Date dynamique
            const today = new Date();
            const dateStr = `${today.getDate().toString().padStart(2, '0')}/${(today.getMonth() + 1).toString().padStart(2, '0')}/${today.getFullYear().toString().substr(2)}`;
            document.getElementById('results-title').textContent = `üìÖ Partie du ${dateStr}`;

            // Calculer les totaux
            const playerTotals = {};
            let totalPar = Object.values(gameState.pars).reduce((sum, par) => sum + par, 0);

            gameState.players.forEach(player => {
                const total = gameState.scores[player].reduce((sum, score) => sum + score, 0);
                playerTotals[player] = {
                    total: total,
                    diff: total - totalPar
                };
            });

            // D√©terminer le gagnant
            const minDiff = Math.min(...Object.values(playerTotals).map(p => p.diff));
            const winners = gameState.players.filter(player => playerTotals[player].diff === minDiff);

            // Afficher le gagnant
            const winnerDiv = document.getElementById('winner-announcement');
            if (winners.length === 1) {
                winnerDiv.innerHTML = `<div class="winner">üèÜ Gagnant : ${winners[0]}</div>`;
            } else {
                winnerDiv.innerHTML = `<div class="winner">ü§ù √âgalit√© : ${winners.join(', ')}</div>`;
            }

            // Cr√©er le tableau final
            createFinalTable(playerTotals, totalPar);
        }

        function createFinalTable(playerTotals, totalPar) {
            const table = document.getElementById('final-table');
            table.innerHTML = '';

            // En-t√™te
            const headerRow = document.createElement('tr');
            headerRow.innerHTML = '<th>Trou</th>' + gameState.players.map(player => `<th>${player}</th>`).join('');
            table.appendChild(headerRow);

            // Lignes des trous
            for (let hole = 1; hole <= gameState.totalHoles; hole++) {
                const row = document.createElement('tr');
                row.innerHTML = `<td><strong>${hole}</strong></td>` +
                    gameState.players.map(player => `<td>${gameState.scores[player][hole - 1] || '-'}</td>`).join('');
                table.appendChild(row);
            }

            // Ligne des totaux
            const totalRow = document.createElement('tr');
            totalRow.innerHTML = '<td><strong>Total</strong></td>' +
                gameState.players.map(player => {
                    const diff = playerTotals[player].diff;
                    const diffText = diff > 0 ? `+${diff}` : diff === 0 ? '¬±0' : `${diff}`;
                    return `<td><strong>${playerTotals[player].total} (${diffText})</strong></td>`;
                }).join('');
            table.appendChild(totalRow);
        }

        function newGame() {
            gameState = {
                players: ['Arthur'],
                totalHoles: 9,
                currentHole: 1,
                scores: {},
                pars: {},
                gameStarted: false
            };

            document.getElementById('results-screen').classList.add('hidden');
            document.getElementById('config-screen').classList.remove('hidden');
            
            // Reset de l'interface de config
            document.querySelectorAll('.btn.selected').forEach(btn => btn.classList.remove('selected'));
            document.getElementById('players-names').classList.add('hidden');
            document.getElementById('start-btn').disabled = true;
        }
    </script>
</body>
</html>
