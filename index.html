<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Golf Score">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Ccircle cx='256' cy='256' r='256' fill='%23065f46'/%3E%3Cpath d='M256 100c-86.066 0-156 69.934-156 156s69.934 156 156 156 156-69.934 156-156-69.934-156-156-156zm0 280c-68.374 0-124-55.626-124-124s55.626-124 124-124 124 55.626 124 124-55.626 124-124 124z' fill='white'/%3E%3Ccircle cx='256' cy='256' r='20' fill='white'/%3E%3C/svg%3E">
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiR29sZiBTY29yZSBUcmFja2VyIiwic2hvcnRfbmFtZSI6IkdvbGYgU2NvcmUiLCJzdGFydF91cmwiOiIuLyIsInRoZW1lX2NvbG9yIjoiIzA2NWY0NiIsImJhY2tncm91bmRfY29sb3IiOiIjZmZmZmZmIiwiZGlzcGxheSI6InN0YW5kYWxvbmUiLCJpY29ucyI6W3sic3JjIjoiZGF0YTppbWFnZS9zdmcreG1sLCUzQ3N2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZpZXdCb3g9JzAgMCA1MTIgNTEyJyUzRSUzQ2NpcmNsZSBjeD0nMjU2JyBjeT0nMjU2JyByPScyNTYnIGZpbGw9JyUyMzA2NWY0NicvJTNFJTNDcGF0aCBkPSdNMjU2IDEwMGMtODYuMDY2IDAtMTU2IDY5LjkzNC0xNTYgMTU2czY5LjkzNCAxNTYgMTU2IDE1NiAxNTYtNjkuOTM0IDE1Ni0xNTZzLTY5LjkzNC0xNTYtMTU2LTE1NnptMCAyODBjLTY4LjM3NCAwLTEyNC01NS42MjYtMTI0LTEyNHM1NS42MjYtMTI0IDEyNC0xMjQgMTI0IDU1LjYyNiAxMjQgMTI0LTU1LjYyNiAxMjQtMTI0IDEyNHonIGZpbGw9J3doaXRlJy8lM0UlM0NjaXJjbGUgY3g9JzI1NicgY3k9JzI1Nicgcj0nMjAnIGZpbGw9J3doaXRlJy8lM0UlM0Mvc3ZnJTNF","sizes":"512x512","type":"image/svg+xml"}]}">
    <title>Golf Score Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #ffffff;
            color: #1f2937;
            height: 100vh;
            overflow: hidden;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }

        .container {
            height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 20px;
            max-width: 100vw;
        }

        .screen {
            display: none;
            flex-direction: column;
            height: 100%;
            justify-content: space-between;
        }

        .screen.active {
            display: flex;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-top: 20px;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
            color: #065f46;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #065f46;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 16px;
            background-color: #ffffff;
            transition: border-color 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: #065f46;
        }

        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            min-height: 48px;
        }

        .btn-primary {
            background-color: #3b82f6;
            color: white;
        }

        .btn-primary:hover {
            background-color: #2563eb;
        }

        .btn-secondary {
            background-color: #ffffff;
            color: #065f46;
            border: 2px solid #e5e7eb;
        }

        .btn-secondary:hover {
            background-color: #f9fafb;
        }

        .btn-secondary.active {
            background-color: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        /* Boutons sp√©cifiques pour l'√©cran de jeu */
        .game-screen .btn-secondary {
            background-color: #3b82f6;
            color: white;
            border: 2px solid #3b82f6;
        }

        .game-screen .btn-secondary:hover {
            background-color: #2563eb;
        }

        .game-screen .btn-secondary.active {
            background-color: #065f46;
            color: white;
            border-color: #065f46;
        }

        .btn-gray {
            background-color: #6b7280;
            color: white;
        }

        .btn-gray:hover {
            background-color: #4b5563;
        }

        .navigation {
            display: flex;
            gap: 15px;
            margin-top: auto;
            padding-top: 20px;
        }

        .score-header {
            background-color: #f8fafc;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-around;
            font-weight: 600;
        }

        .score-item {
            text-align: center;
        }

        .score-item .name {
            font-size: 14px;
            color: #6b7280;
        }

        .score-item .score {
            font-size: 18px;
            color: #065f46;
        }

        .hole-info {
            text-align: center;
            margin-bottom: 25px;
        }

        .hole-info h2 {
            font-size: 22px;
            color: #065f46;
            margin-bottom: 10px;
        }

        .par-selection {
            margin-bottom: 25px;
        }

        .score-inputs {
            margin-bottom: 25px;
        }

        .player-score {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            padding: 10px;
            background-color: #f8fafc;
            border-radius: 8px;
        }

        .player-name {
            font-weight: 500;
            min-width: 60px;
        }

        .score-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .score-btn {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 8px;
            background-color: #3b82f6;
            color: white;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
        }

        .score-btn:hover {
            background-color: #2563eb;
        }

        .score-display {
            min-width: 40px;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
        }

        .result-emoji {
            font-size: 20px;
            margin-left: 10px;
        }

        .final-results {
            background-color: #065f46;
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            max-height: 60vh;
            overflow-y: auto;
        }

        .final-results h2 {
            text-align: center;
            margin-bottom: 20px;
            font-size: 20px;
        }

        .final-table {
            width: 100%;
            border-collapse: collapse;
        }

        .final-table th,
        .final-table td {
            padding: 8px 4px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            font-size: 14px;
        }

        .final-table th {
            font-weight: 600;
            background-color: rgba(255, 255, 255, 0.1);
        }

        .winner-text {
            text-align: center;
            font-size: 18px;
            font-weight: 600;
            margin-top: 15px;
        }

        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .form-content {
            flex: 1;
            overflow-y: auto;
            padding-right: 10px;
            margin-right: -10px;
        }

        .par-info {
            font-size: 14px;
            color: #6b7280;
            text-align: center;
            margin-top: 5px;
        }

        @media (max-width: 380px) {
            .container {
                padding: 15px;
            }
            
            .btn {
                padding: 10px 16px;
                font-size: 14px;
            }
            
            .final-table th,
            .final-table td {
                padding: 6px 2px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Interface 1: Configuration -->
        <div class="screen active" id="config-screen">
            <div class="header">
                <h1>üõ†Ô∏è Config de la partie</h1>
            </div>
            
            <div class="content">
                <div class="form-content">
                    <div class="form-group">
                        <label for="golf-name">Nom du golf</label>
                        <input type="text" id="golf-name" class="form-input" placeholder="Saisissez le nom du golf">
                    </div>

                    <div class="form-group">
                        <label>Nombre de joueurs en plus de moi</label>
                        <div class="button-group">
                            <button class="btn btn-secondary" data-players="0">0</button>
                            <button class="btn btn-secondary" data-players="1">1</button>
                            <button class="btn btn-secondary" data-players="2">2</button>
                            <button class="btn btn-secondary" data-players="3">3</button>
                        </div>
                    </div>

                    <div id="player-names" style="display: none;">
                        <div class="form-group">
                            <label>Pr√©noms des joueurs</label>
                            <div id="name-inputs"></div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Nombre de trous</label>
                        <div class="button-group">
                            <button class="btn btn-secondary" data-holes="9">9 trous</button>
                            <button class="btn btn-secondary" data-holes="18">18 trous</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="navigation">
                <button class="btn btn-primary" id="start-game" style="width: 100%;">Commencer la partie</button>
            </div>
        </div>

        <!-- Interface 2: Carte des scores -->
        <div class="screen game-screen" id="game-screen">
            <div class="header">
                <h1>‚õ≥ Carte des scores</h1>
            </div>

            <div id="score-header" class="score-header"></div>

            <div class="content">
                <div class="hole-info">
                    <h2 id="hole-title">Trou 1</h2>
                    <div class="par-selection">
                        <label>Par du trou</label>
                        <div class="button-group">
                            <button class="btn btn-secondary" data-par="3">Par 3</button>
                            <button class="btn btn-secondary" data-par="4">Par 4</button>
                            <button class="btn btn-secondary" data-par="5">Par 5</button>
                        </div>
                        <div class="par-info" id="par-info">S√©lectionnez le par du trou</div>
                    </div>
                </div>

                <div class="score-inputs" id="score-inputs"></div>
            </div>

            <div class="navigation">
                <button class="btn btn-gray" id="back-btn">Retour</button>
                <button class="btn btn-primary" id="next-hole-btn">Trou suivant</button>
            </div>
        </div>

        <!-- Interface 3: R√©sultats finaux -->
        <div class="screen" id="results-screen">
            <div class="header">
                <h1 id="results-title">üìÖ Partie du 26/06/25</h1>
            </div>

            <div class="content">
                <div class="final-results">
                    <h2>R√©sultats de la partie</h2>
                    <table class="final-table" id="final-table"></table>
                    <div class="winner-text" id="winner-text"></div>
                </div>
            </div>

            <div class="navigation">
                <button class="btn btn-primary" id="new-game-btn" style="width: 100%;">Nouvelle partie</button>
            </div>
        </div>
    </div>

    <script>
        // Variables globales
        let gameState = {
            golfName: '',
            players: ['Arthur'],
            totalHoles: 9,
            currentHole: 1,
            holes: [],
            scores: {}
        };

        // Elements DOM
        const screens = {
            config: document.getElementById('config-screen'),
            game: document.getElementById('game-screen'),
            results: document.getElementById('results-screen')
        };

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            setupConfigScreen();
            setupGameScreen();
            setupResultsScreen();
        }

        function setupConfigScreen() {
            // S√©lection du nombre de joueurs
            document.querySelectorAll('[data-players]').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('[data-players]').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    const playerCount = parseInt(this.dataset.players);
                    const playerNamesDiv = document.getElementById('player-names');
                    const nameInputsDiv = document.getElementById('name-inputs');
                    
                    if (playerCount > 0) {
                        playerNamesDiv.style.display = 'block';
                        nameInputsDiv.innerHTML = '';
                        
                        for (let i = 1; i <= playerCount; i++) {
                            const input = document.createElement('input');
                            input.type = 'text';
                            input.className = 'form-input';
                            input.placeholder = `Pr√©nom joueur ${i}`;
                            input.style.marginBottom = '10px';
                            input.id = `player-${i}`;
                            nameInputsDiv.appendChild(input);
                        }
                    } else {
                        playerNamesDiv.style.display = 'none';
                    }
                });
            });

            // S√©lection du nombre de trous
            document.querySelectorAll('[data-holes]').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('[data-holes]').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                });
            });

            // D√©marrage de la partie
            document.getElementById('start-game').addEventListener('click', startGame);
        }

        function startGame() {
            const golfName = document.getElementById('golf-name').value.trim();
            const selectedPlayers = document.querySelector('[data-players].active');
            const selectedHoles = document.querySelector('[data-holes].active');

            if (!golfName) {
                alert('Veuillez saisir le nom du golf');
                return;
            }

            if (!selectedPlayers || !selectedHoles) {
                alert('Veuillez s√©lectionner le nombre de joueurs et de trous');
                return;
            }

            gameState.golfName = golfName;
            gameState.totalHoles = parseInt(selectedHoles.dataset.holes);
            gameState.players = ['Arthur'];

            const playerCount = parseInt(selectedPlayers.dataset.players);
            for (let i = 1; i <= playerCount; i++) {
                const playerName = document.getElementById(`player-${i}`).value.trim();
                if (!playerName) {
                    alert(`Veuillez saisir le pr√©nom du joueur ${i}`);
                    return;
                }
                gameState.players.push(playerName);
            }

            // Initialiser les scores
            gameState.scores = {};
            gameState.players.forEach(player => {
                gameState.scores[player] = [];
            });

            // Initialiser les trous
            gameState.holes = Array(gameState.totalHoles).fill(0).map(() => ({ par: 4 }));
            gameState.currentHole = 1;

            showScreen('game');
            updateGameScreen();
        }

        function setupGameScreen() {
            // S√©lection du par
            document.querySelectorAll('[data-par]').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('[data-par]').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    const par = parseInt(this.dataset.par);
                    gameState.holes[gameState.currentHole - 1].par = par;
                    document.getElementById('par-info').textContent = `Par ${par} s√©lectionn√©`;
                    
                    // R√©initialiser les scores avec le par comme base
                    gameState.players.forEach(player => {
                        gameState.scores[player][gameState.currentHole - 1] = par;
                    });
                    
                    // Mettre √† jour l'affichage des scores
                    updateScoreInputs();
                    updateScoreHeader();
                });
            });

            // Navigation
            document.getElementById('back-btn').addEventListener('click', () => {
                if (gameState.currentHole > 1) {
                    gameState.currentHole--;
                    updateGameScreen();
                }
            });

            document.getElementById('next-hole-btn').addEventListener('click', () => {
                if (validateCurrentHole()) {
                    if (gameState.currentHole < gameState.totalHoles) {
                        gameState.currentHole++;
                        updateGameScreen();
                    } else {
                        showResults();
                    }
                }
            });
        }

        function updateGameScreen() {
            const hole = gameState.currentHole;
            const holeData = gameState.holes[hole - 1];

            // Titre du trou
            document.getElementById('hole-title').textContent = `Trou ${hole}`;

            // Mise √† jour du par
            document.querySelectorAll('[data-par]').forEach(b => b.classList.remove('active'));
            document.querySelector(`[data-par="${holeData.par}"]`).classList.add('active');
            document.getElementById('par-info').textContent = `Par ${holeData.par} s√©lectionn√©`;

            // Mise √† jour des scores globaux
            updateScoreHeader();

            // Mise √† jour des contr√¥les de score
            updateScoreInputs();

            // Mise √† jour du bouton suivant
            const nextBtn = document.getElementById('next-hole-btn');
            nextBtn.textContent = hole === gameState.totalHoles ? 'Terminer' : 'Trou suivant';
        }

        function updateScoreHeader() {
            const headerDiv = document.getElementById('score-header');
            headerDiv.innerHTML = '';

            gameState.players.forEach(player => {
                const totalScore = calculateTotalScore(player);
                const totalPar = calculateTotalPar();
                const relativeScore = totalScore - totalPar;

                const scoreItem = document.createElement('div');
                scoreItem.className = 'score-item';
                scoreItem.innerHTML = `
                    <div class="name">${player}</div>
                    <div class="score">${relativeScore >= 0 ? '+' : ''}${relativeScore}</div>
                `;
                headerDiv.appendChild(scoreItem);
            });
        }

        function updateScoreInputs() {
            const inputsDiv = document.getElementById('score-inputs');
            inputsDiv.innerHTML = '';

            gameState.players.forEach(player => {
                const par = gameState.holes[gameState.currentHole - 1].par;
                const currentScore = gameState.scores[player][gameState.currentHole - 1] || par;

                const playerDiv = document.createElement('div');
                playerDiv.className = 'player-score';
                playerDiv.innerHTML = `
                    <div class="player-name">${player}</div>
                    <div class="score-control">
                        <button class="score-btn" onclick="changeScore('${player}', -1)">-</button>
                        <div class="score-display" id="score-${player}">${currentScore}</div>
                        <button class="score-btn" onclick="changeScore('${player}', 1)">+</button>
                        <div class="result-emoji" id="emoji-${player}">${getScoreEmoji(currentScore, par)}</div>
                    </div>
                `;
                inputsDiv.appendChild(playerDiv);

                // Sauvegarder le score
                gameState.scores[player][gameState.currentHole - 1] = currentScore;
            });
        }

        function changeScore(player, delta) {
            const currentScore = gameState.scores[player][gameState.currentHole - 1] || 4;
            const newScore = Math.max(1, currentScore + delta);
            
            gameState.scores[player][gameState.currentHole - 1] = newScore;
            
            const scoreDisplay = document.getElementById(`score-${player}`);
            const emojiDisplay = document.getElementById(`emoji-${player}`);
            const par = gameState.holes[gameState.currentHole - 1].par;
            
            scoreDisplay.textContent = newScore;
            emojiDisplay.textContent = getScoreEmoji(newScore, par);
            
            updateScoreHeader();
        }

        function getScoreEmoji(score, par) {
            const diff = score - par;
            if (diff <= -2) return 'ü¶Ö'; // Eagle ou mieux
            if (diff === -1) return 'üïäÔ∏è'; // Birdie
            if (diff === 0) return '‚úÖ'; // Par
            if (diff === 1) return '‚ö†Ô∏è'; // Bogey
            return '‚ùó'; // Double bogey ou pire
        }

        function validateCurrentHole() {
            // V√©rifier que tous les joueurs ont un score
            for (let player of gameState.players) {
                if (!gameState.scores[player][gameState.currentHole - 1]) {
                    alert('Veuillez saisir les scores de tous les joueurs');
                    return false;
                }
            }
            return true;
        }

        function calculateTotalScore(player) {
            return gameState.scores[player].slice(0, gameState.currentHole - 1).reduce((sum, score) => sum + (score || 0), 0);
        }

        function calculateTotalPar() {
            return gameState.holes.slice(0, gameState.currentHole - 1).reduce((sum, hole) => sum + hole.par, 0);
        }

        function setupResultsScreen() {
            document.getElementById('new-game-btn').addEventListener('click', () => {
                // Reset du jeu
                gameState = {
                    golfName: '',
                    players: ['Arthur'],
                    totalHoles: 9,
                    currentHole: 1,
                    holes: [],
                    scores: {}
                };
                
                // Reset des formulaires
                document.getElementById('golf-name').value = '';
                document.querySelectorAll('.btn-secondary').forEach(btn => btn.classList.remove('active'));
                document.getElementById('player-names').style.display = 'none';
                
                showScreen('config');
            });
        }

        function showResults() {
            const today = new Date();
            const dateStr = today.toLocaleDateString('fr-FR', { 
                day: '2-digit', 
                month: '2-digit', 
                year: '2-digit' 
            });
            
            document.getElementById('results-title').textContent = `üìÖ Partie du ${dateStr} au Golf ${gameState.golfName}`;
            
            // Cr√©er le tableau final en format colonne
            const table = document.getElementById('final-table');
            table.innerHTML = '';
            
            // En-t√™te avec les noms des joueurs
            const headerRow = document.createElement('tr');
            headerRow.innerHTML = '<th>Trou</th><th>Par</th>';
            gameState.players.forEach(player => {
                headerRow.innerHTML += `<th>${player}</th>`;
            });
            table.appendChild(headerRow);
            
            // Une ligne par trou
            for (let i = 0; i < gameState.totalHoles; i++) {
                const row = document.createElement('tr');
                row.innerHTML = `<td><strong>T${i + 1}</strong></td><td>${gameState.holes[i].par}</td>`;
                
                gameState.players.forEach(player => {
                    const score = gameState.scores[player][i];
                    const par = gameState.holes[i].par;
                    const diff = score - par;
                    const diffText = diff === 0 ? 'Par' : (diff > 0 ? `+${diff}` : `${diff}`);
                    row.innerHTML += `<td>${score}<br><small style="opacity: 0.8;">${diffText}</small></td>`;
                });
                
                table.appendChild(row);
            }
            
            // Ligne de total
            const totalRow = document.createElement('tr');
            totalRow.style.borderTop = '2px solid rgba(255, 255, 255, 0.5)';
            totalRow.style.fontWeight = 'bold';
            
            const totalPar = gameState.holes.reduce((sum, hole) => sum + hole.par, 0);
            totalRow.innerHTML = `<td><strong>Total</strong></td><td><strong>${totalPar}</strong></td>`;
            
            const finalScores = [];
            gameState.players.forEach(player => {
                const totalScore = gameState.scores[player].reduce((sum, score) => sum + score, 0);
                const relativeScore = totalScore - totalPar;
                totalRow.innerHTML += `<td><strong>${totalScore}<br><small>(${relativeScore >= 0 ? '+' : ''}${relativeScore})</small></strong></td>`;
                finalScores.push({ player, relativeScore });
            });
            
            table.appendChild(totalRow);
            
            // D√©terminer le gagnant
            const winnerText = document.getElementById('winner-text');
            finalScores.sort((a, b) => a.relativeScore - b.relativeScore);
            
            const lowestScore = finalScores[0].relativeScore;
            const winners = finalScores.filter(s => s.relativeScore === lowestScore);
            
            if (winners.length > 1) {
                winnerText.textContent = `√âgalit√© entre ${winners.map(w => w.player).join(' et ')} !`;
            } else {
                winnerText.textContent = `üèÜ Gagnant : ${winners[0].player} !`;
            }
            
            showScreen('results');
        }

        function showScreen(screenName) {
            Object.values(screens).forEach(screen => screen.classList.remove('active'));
            screens[screenName].classList.add('active');
        }
    </script>
</body>
</html>
